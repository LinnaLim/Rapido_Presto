"use strict";var LesHamburgers=LesHamburgers||{};LesHamburgers.Jeu=function(){this.tempsRestant,this.tempsTxt,this.scoreTxt},LesHamburgers.Jeu.prototype={init:function(){this.tempsRestant=LesHamburgers.TEMPS_JEU,LesHamburgers.score=0,this.scoreJoueur=0,this.nbBonIngredient=0,this.nbHamburgerParfait=0,this.nbIngredientDansLeTableauJoueur=0,this.nbIngredientDuHamburger=0,this.lesIndexDesIngredientATrouver=[],this.tableauHamburgerAFaire=[],this.tableauIndexDuJoueur=[],this.tableauHamburgerJoueur=[]},create:function(){this.afficherInterfaceDuJeu(),this.genererHamburgerAFaire(),this.mettrePainBasDuJoueur(),this.scoreTxt=this.add.bitmapText(this.game.width/1.3,this.game.height-5,"fonteTexte","ARGENT: "+LesHamburgers.score.toString()+"$",50),this.scoreTxt.anchor.set(0,1),this.scoreTxt.tint=4339239,this.tempsTxt=this.add.bitmapText(10,this.game.height-5,"fonteTexte","Temps restant: "+this.tempsRestant,50),this.tempsTxt.anchor.set(0,1),this.tempsTxt.tint=4339239,this.minuterieTemps=this.time.events.loop(Phaser.Timer.SECOND,this.diminuerTemps,this)},diminuerTemps:function(){this.tempsRestant--,this.tempsTxt.text="Temps restant: "+this.tempsRestant,0==this.tempsRestant&&this.allerEcranFin()},afficherInterfaceDuJeu:function(){this.add.image(0,0,"arrierePlan");var e=this.game.width,t=0;if(!this.game.device.iOS){var r=this.add.button(e,t,"boutonPleinEcranImg",this.gererPleinEcran,this);r.anchor.set(1.5,0),r.scale.setTo(1.5,1.5),this.world.bringToTop(r),r.frame=this.scale.isFullScreen?1:0}var s=this.add.button(e,t,"boutonPauseImg",this.gererPauseJeu,this);s.anchor.set(3,0),s.scale.setTo(1.5,1.5),this.world.bringToTop(s);var i=this.add.button(e,t,"boutonSonImg",this.gererPauseSon,this);i.anchor.set(4.5,0),i.scale.setTo(1.5,1.5),this.world.bringToTop(i);var a=null!=this.sonAmbiance&&!this.sonAmbiance.isPlaying;i.frame=a?1:0,this.afficherBtnIngredient()},afficherBtnIngredient:function(){for(var r,e=this.game.width,t=(this.game.height-30*LesHamburgers.NB_INGREDIENT-30*(LesHamburgers.NB_INGREDIENT-1))/2,s=[],i=1;i<LesHamburgers.NB_INGREDIENT+1;i++)r=t+60*i,s[i]=this.add.button(e,r,"ingredientBtn",this.mettreIngredient,this),s[i].frame=i,s[i].anchor.set(1);var a=this.add.button(e,t,"ingredientBtn",this.finirHamburgerJoueur,this);a.anchor.set(1);var n=this.add.button(e,t+60*(LesHamburgers.NB_INGREDIENT+1),"poubelleImg",this.effacerHamburgerJoueur,this);n.anchor.set(1)},mettreIngredient:function(e){var t=this.game.width-this.game.width/4,r=this.game.height-LesHamburgers.HAUTEUR_INGREDIENT;if(this.nbIngredientDansLeTableauJoueur>5)this.finirHamburgerJoueur();else{this.add.audio("sonFrappe",1).play();var s=e.frame-1;this.tableauIndexDuJoueur[this.nbIngredientDansLeTableauJoueur]=s;var i=r-LesHamburgers.HAUTEUR_INGREDIENT*(this.nbIngredientDansLeTableauJoueur+1);this.tableauHamburgerJoueur[this.nbIngredientDansLeTableauJoueur]=this.add.sprite(t,i,"burger-sprite",s),this.tableauHamburgerJoueur[this.nbIngredientDansLeTableauJoueur].anchor.set(.5),this.nbIngredientDansLeTableauJoueur++}},finirHamburgerJoueur:function(){this.sonArgent=this.add.audio("sonArgent",1).play(),this.mettrePainHautDuJoueur(),this.animerLesHamburgers(),this.verifierHamburgerDuJoueur(),this.nbIngredientDansLeTableauJoueur=0},effacerHamburgerJoueur:function(){this.add.audio("sonPoubelle",1).play();for(var e=0;e<this.tableauHamburgerJoueur.length;e++)this.tableauHamburgerJoueur[e].destroy();this.nbIngredientDansLeTableauJoueur=0,this.tableauHamburgerJoueur=[],this.tableauIndexDuJoueur=[],this.mettrePainBasDuJoueur()},genererHamburgerAFaire:function(){this.nbIngredientDuHamburger=Math.floor(Math.random()*(LesHamburgers.NB_INGREDIENT-1-2+1)+2);for(var t,r,e=this.game.height-LesHamburgers.HAUTEUR_INGREDIENT,s=0;s<this.nbIngredientDuHamburger;s++)t=Math.floor(Math.random()*LesHamburgers.NB_INGREDIENT+1),r=e-LesHamburgers.HAUTEUR_INGREDIENT*(s+1),t>LesHamburgers.NB_INGREDIENT-1&&(t=4),this.tableauHamburgerAFaire[s]=this.add.sprite(this.game.width/4,r,"burger-sprite",t),this.tableauHamburgerAFaire[s].anchor.set(.5),this.lesIndexDesIngredientATrouver[s]=t;var i=this.add.sprite(this.game.width/4,this.game.height-LesHamburgers.HAUTEUR_INGREDIENT,"burger-sprite",6);this.tableauHamburgerAFaire.push(i),i.anchor.set(.5);var a=this.add.image(this.game.width/4,e-LesHamburgers.HAUTEUR_INGREDIENT*(this.nbIngredientDuHamburger+1),"painDessus",6);this.tableauHamburgerAFaire.push(a),a.anchor.set(.5)},mettrePainHautDuJoueur:function(){var e=this.add.image(this.game.width-this.game.width/4,this.game.height-LesHamburgers.HAUTEUR_INGREDIENT-LesHamburgers.HAUTEUR_INGREDIENT*(this.nbIngredientDansLeTableauJoueur+1),"painDessus",6);e.anchor.set(.5),this.tableauHamburgerJoueur.push(e)},mettrePainBasDuJoueur:function(){var e=this.add.sprite(this.game.width-this.game.width/4,this.game.height-LesHamburgers.HAUTEUR_INGREDIENT,"burger-sprite",6);e.anchor.set(.5),this.tableauHamburgerJoueur.push(e)},animerLesHamburgers:function(){for(var e=[],t=0;t<this.tableauHamburgerAFaire.length;t++)e[t]=this.add.tween(this.tableauHamburgerAFaire[t]).to({x:-this.game.width},500,Phaser.Easing.Bounce.Outtrue,!0,0,0,!1);for(var r=[],t=0;t<this.tableauHamburgerJoueur.length;t++)r[t]=this.add.tween(this.tableauHamburgerJoueur[t]).to({x:-this.game.width},500,Phaser.Easing.Bounce.Outtrue,!0,0,0,!1);r[0].onComplete.add(this.réinitialiserLeJeu,this)},verifierHamburgerDuJoueur:function(){this.nbBonIngredient=0,this.scoreDeCeHamburger=0;for(var e=0;e<this.lesIndexDesIngredientATrouver.length;e++)this.lesIndexDesIngredientATrouver[e]==this.tableauIndexDuJoueur[e]&&(this.nbBonIngredient++,this.scoreJoueur++,this.scoreDeCeHamburger++,this.nbBonIngredient==this.nbIngredientDuHamburger&&this.nbIngredientDansLeTableauJoueur==this.lesIndexDesIngredientATrouver.length&&(this.nbHamburgerParfait++,this.scoreJoueur+=10,this.scoreDeCeHamburger+=10));this.afficherLeScore();var t=new PointBitmap(this.game,this.input.x-40,this.input.y,"fonteTexte",this.scoreDeCeHamburger.toString(),48);t.tint=4339239,t.anchor.set(1,.5)},"réinitialiserLeJeu":function(){this.nbIngredientDuHamburger=0,this.scoreDeCeHamburger=0,this.tableauIndexDuJoueur=[],this.lesIndexDesIngredientATrouver=[],this.mettrePainBasDuJoueur(),this.genererHamburgerAFaire()},afficherLeScore:function(){LesHamburgers.score=this.scoreJoueur,this.scoreTxt.text="ARGENT: "+LesHamburgers.score.toString()+"$"},gererPleinEcran:function(e){this.game.scale.isFullScreen?(Ecran.enleverPleinEcran(),e.frame=0):(Ecran.mettrePleinEcran(),e.frame=1),this.game.device.desktop||Ecran.verrouillerEcran(Ecran.PAYSAGE)},gererPauseSon:function(e){LesHamburgers.sonAmbiance.isPlaying?(LesHamburgers.sonAmbiance.stop(),e.frame=1):(LesHamburgers.sonAmbiance.loopFull(.5),e.frame=0)},gererPauseJeu:function(){this.game.paused=!0;var t=this.add.graphics(0,0);t.lineStyle(5,14708757),t.beginFill(16769925),t.drawRect(0,this.game.height/12,this.game.width,175);var r=this.add.bitmapText(this.game.width/2,this.game.height/5,"fonteTexte","Le jeu est en pause.\n\n Cliquer sur l'ecran pour reprendre la partie.",50);r.anchor.set(.5),r.tint=4339239,this.input.onDown.addOnce(function(){r.destroy(),t.destroy(),this.game.paused=!1},this)},allerEcranFin:function(){this.time.events.remove(this.minuterieTemps),this.state.start("FinJeu")}};